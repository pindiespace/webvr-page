(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function Emitter(){this.callbacks={}}Emitter.prototype.emit=function(eventName){var callbacks=this.callbacks[eventName];if(!callbacks){return}var args=[].slice.call(arguments);args.shift();for(var i=0;i<callbacks.length;i++){callbacks[i].apply(this,args)}};Emitter.prototype.on=function(eventName,callback){if(eventName in this.callbacks){this.callbacks[eventName].push(callback)}else{this.callbacks[eventName]=[callback]}};module.exports=Emitter},{}],2:[function(require,module,exports){var WebVRPageManager=require("./webvr-page-manager.js");window.WebVRPageConfig=window.WebVRPageConfig||{};window.WebVRPageManager=WebVRPageManager},{"./webvr-page-manager.js":5}],3:[function(require,module,exports){var Modes={UNKNOWN:0,NORMAL:1,MAGIC_WINDOW:2,VR:3};module.exports=Modes},{}],4:[function(require,module,exports){var Util={};Util.getUniqueId=function(prefix){var i=Math.floor(Math.random()*999)+100;var pfx=prefix||"";function inc(pfx){if(!pfx){pfx=""}else{pfx+="-"}return pfx+i++}return inc}();Util.fullScreenClass=function(fullscreenClass){var head=document.querySelector("head");var s=document.createElement("style");s.type="text/css";s.id="fullscreen";var rules="."+fullscreenClass+" {\n"+"	position: fixed !important;\n"+"	box-sizing: border-box !important;\n"+"	width: 100% !important;\n"+"	height: 100% !important;\n"+"	margin: 0 !important;\n"+"	left: 0 !important;\n"+"	top: 0 !important;\n"+" right:0 !important;\n"+" bottom:0 !important;\n"+"	z-index: 2147483647 !important;\n"+" background:black;\n"+"}\n";if(s.styleSheet){s.styleSheet.cssText=rules}else{var ruleNode=document.createTextNode(rules);s.appendChild(ruleNode)}head.appendChild(s);return fullscreenClass}("polyfill-full-screen");Util.isFullScreen=function(){if(document.fullscreenElement===null){return false}return true};Util.setFullscreen=function(){var hasStyles=false;var escHandler=function(e){if(e.keyCode==27){e.stopImmediatePropagation();document.exitFullscreen()}};if(!("fullscreenElement"in document)){Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||null}})}if(!("fullscreenEnabled"in document)){Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.msFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||false}})}if(document.fullscreenEnabled){Element.prototype.requestFullscreen=Element.prototype.requestFullscreen||Element.prototype.webkitRequestFullscreen||Element.prototype.mozRequestFullScreen||Element.prototype.msRequestFullscreen||function(elem){console.log("in requestFullscreen polyfill fn");if(elem.nodeName==="IFRAME"&&!elem.allowfullscreen){document.fullscreenElement=null;return}if(document.fullscreenElement===null){document.fullscreenElement=this}document.addEventListener("keydown",escHandler,false);this.classList.add(Util.fullscreenClass);var event=new CustomEvent("fullscreenchange");if(typeof document.onfullscreenchange=="function"){document.onfullscreenchange(event)}else{document.dispatchEvent(event)}};var screenChange=function(e){e.stopImmediatePropagation();if(e.type!=="fullscreenchange"){console.log("dispatching fullscreenchange");var event=new CustomEvent("fullscreenchange");document.dispatchEvent(event)}};document.addEventListener("webkitfullscreenchange",screenChange);document.addEventListener("mozfullscreenchange",screenChange);document.addEventListener("MSFullscreenChange",screenChange);document.exitFullscreen=document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||function(e){console.log("in exitfullscreen polyfill fn");if(document.fullscreenEnabled!=null){document.removeEventListener("keydown",escHandler,false);if(document.fullscreenElement){document.fullscreenElement.classList.remove(Util.fullscreenClass);document.fullscreenElement=null}}var event=new CustomEvent("fullscreenchange");if(typeof document.onfullscreenchange=="function"){document.onfullscreenchange(event)}else{document.dispatchEvent(event)}}}return function(){return document.fullscreenEnabled}}();module.exports=Util},{}],5:[function(require,module,exports){var Emitter=require("./emitter.js");var Modes=require("./modes.js");var Util=require("./util.js");var WebVRPagePlayer=require("./webvr-page-player.js");function WebVRPageManager(renderer,effect,camera,params){this.params=params||{};this.prefix="webvr";this.uid=Util.getUniqueId(this.prefix);this.renderer=renderer;this.effect=effect;this.camera=camera;this.player=new WebVRPagePlayer(renderer,params);this.getDeviceByType_(HMDVRDevice).then(function(hmd){this.hmd=hmd}.bind(this));var size=this.player.getSize();this.resize(size.width,size.height);this.listenResize_();this.listenFullscreen_();this.listenOrientation_();this.emit("initialized")}WebVRPageManager.prototype=new Emitter;WebVRPageManager.prototype.render=function(scene){this.effect.render(scene,this.camera)};WebVRPageManager.prototype.getDeviceByType_=function(type){return new Promise(function(resolve,reject){navigator.getVRDevices().then(function(devices){for(var i=0;i<devices.length;i++){if(devices[i]instanceof type){resolve(devices[i]);break}}resolve(null)},function(){resolve(null)})})};WebVRPageManager.prototype.listenFullscreen_=function(){document.addEventListener("fullscreenchange",this.onFullscreenChange_.bind(this));document.addEventListener("exitFullscreen",this.exitFullscreen_.bind(this))};WebVRPageManager.prototype.listenOrientation_=function(){window.addEventListener("orientationchange",this.onOrientationChange_.bind(this))};WebVRPageManager.prototype.listenResize_=function(){this.view=window;this.view.addEventListener("resize",function(e){this.onResize_(e)}.bind(this),false)};WebVRPageManager.prototype.onResize_=function(e){console.log("resize event");var size=this.player.getSize();this.resize(size.width,size.height)};WebVRPageManager.prototype.resize=function(width,height){this.camera.aspect=width/height;this.camera.updateProjectionMatrix();this.effect.setSize(width,height)};WebVRPageManager.prototype.onFullscreenChange_=function(e){console.log("FULLSCREENCHANGE E IS A:"+e);this.player.onFullscreenChange_();console.log("fullscreen change")};WebVRPageManager.prototype.onOrientationChange_=function(e){console.log("ORIENTATION E IS A:"+e);console.log("orientation change")};WebVRPageManager.prototype.requestFullscreen_=function(){console.log("entering fullscreen");this.player.requestFullscreen_();var canvas=this.player.getContainer();canvas.requestFullscreen({vrDisplay:this.hmd})};WebVRPageManager.prototype.exitFullscreen_=function(){console.log("exiting fullscreen");document.exitFullscreen()};module.exports=WebVRPageManager},{"./emitter.js":1,"./modes.js":3,"./util.js":4,"./webvr-page-player.js":6}],6:[function(require,module,exports){var Emitter=require("./emitter.js");var Modes=require("./modes.js");var Util=require("./util.js");function WebVRPagePlayer(renderer,params){this.params=params||{};this.fullscreen=false;this.renderer=renderer;this.dom=this.renderer.domElement.parentNode}WebVRPagePlayer.prototype=new Emitter;WebVRPagePlayer.prototype.requestFullscreen_=function(){};WebVRPagePlayer.prototype.onFullscreenChange_=function(){console.log("in Player fullscreen change");if(this.fullscreen===true){this.fullscreen=false}else{this.fullscreen=true}};WebVRPagePlayer.prototype.getContainer=function(){return this.dom};WebVRPagePlayer.prototype.getCurrentWidth=function(){return parseFloat(getComputedStyle(this.dom).getPropertyValue("width"))};WebVRPagePlayer.prototype.getCurrentHeight=function(){return parseFloat(getComputedStyle(this.dom).getPropertyValue("height"))};WebVRPagePlayer.prototype.getSize=function(){return{width:this.getCurrentWidth(),height:this.getCurrentHeight()}};module.exports=WebVRPagePlayer},{"./emitter.js":1,"./modes.js":3,"./util.js":4}]},{},[2]);